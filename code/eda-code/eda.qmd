---
title: "EDA"
date: "6-20-2024"
output: html_document
---

  
  


# Setup

```{r}
#load needed packages. make sure they are installed.
library(here) #for data loading/saving
library(dplyr)
library(skimr)
library(ggplot2)
```


Load the data.

```{r}
#Path to data. Note the use of the here() package and not absolute paths
load("~/GitHub/Sutherland-PII-project/data/raw-data/Data Cleaning/cleaned_data1.RData")
load("~/GitHub/Sutherland-PII-project/data/raw-data/Data Cleaning/cleaned_data2.RData")
load("~/GitHub/Sutherland-PII-project/data/raw-data/Data Cleaning/cleaned_data3.RData")
load("~/GitHub/Sutherland-PII-project/data/raw-data/Data Cleaning/cleaned_data4.RData")
load("~/GitHub/Sutherland-PII-project/data/raw-data/Data Cleaning/cleaned_games.RData")
```


```{r}
summary(games)
```
```{r}
str(games)
```

Here are some visualizations for each predictor variable for userscore

```{r}
# Boxplot of user scores by game classification
ggplot(games, aes(x = class, y = userscore)) +
  geom_boxplot() +
  labs(title = "User Scores by Game Classification", x = "Game Classification", y = "User Score")

# Scatter plots of user scores vs. other numerical variables, colored by game classification
ggplot(games, aes(x = average_playtime, y = userscore, color = class)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "User Scores vs. Average Playtime by Game Classification", x = "Average Playtime", y = "User Score")

ggplot(games, aes(x = metascore.x, y = userscore, color = class)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "User Scores vs. Metascore by Game Classification", x = "Metascore", y = "User Score")

ggplot(games, aes(x = price, y = userscore, color = class)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "User Scores vs. Price by Game Classification", x = "Price", y = "User Score")

ggplot(games, aes(x = owners, y = userscore, color = class)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "User Scores vs. Owners by Game Classification", x = "Owners", y = "User Score")

ggplot(games, aes(x = median_playtime, y = userscore, color = class)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "User Scores vs. Median Playtime by Game Classification", x = "Median Playtime", y = "User Score")


```



Here is a glm model with all the predictors including developer
```{r}
glm_model <- glm(userscore ~ class + average_playtime + metascore.x + price + owners + median_playtime + developer, 
                 data = games, 
                 family = gaussian())
summary(glm_model)
```
There seem to be a few predictors that are statistically significant:
metascore.x
developerBohemia Interactive
developer Entertainment
developerHaemimont Games
developerSEGA 
developerTripwire Interactive




Below we check the model for non-linearity, homoscedasticity, normally distributed residuals, and identify if there are any influential data points.
```{r}
par(mfrow = c(2, 2))
plot(glm_model)
par(mfrow = c(1, 1))
```



